{"ast":null,"code":"import { defineComponent, inject, watch, onBeforeUnmount, openBlock, createBlock, unref, withCtx, renderSlot, createElementBlock, mergeProps } from 'vue';\nimport '../../../utils/index.mjs';\nimport '../../../tokens/index.mjs';\nimport ForwardRef from './forward-ref.mjs';\nimport { tooltipV2TriggerProps } from './trigger.mjs';\nimport { tooltipV2CommonProps } from './common.mjs';\nimport _export_sfc from '../../../_virtual/plugin-vue_export-helper.mjs';\nimport { tooltipV2RootKey } from '../../../tokens/tooltip-v2.mjs';\nimport { composeEventHandlers } from '../../../utils/dom/event.mjs';\n\nconst __default__ = defineComponent({\n  name: \"ElTooltipV2Trigger\"\n});\n\nconst _sfc_main = /* @__PURE__ */defineComponent({ ...__default__,\n  props: { ...tooltipV2CommonProps,\n    ...tooltipV2TriggerProps\n  },\n\n  setup(__props) {\n    const props = __props;\n    const {\n      onClose,\n      onOpen,\n      onDelayOpen,\n      triggerRef,\n      contentId\n    } = inject(tooltipV2RootKey);\n    let isMousedown = false;\n\n    const setTriggerRef = el => {\n      triggerRef.value = el;\n    };\n\n    const onMouseup = () => {\n      isMousedown = false;\n    };\n\n    const onMouseenter = composeEventHandlers(props.onMouseEnter, onDelayOpen);\n    const onMouseleave = composeEventHandlers(props.onMouseLeave, onClose);\n    const onMousedown = composeEventHandlers(props.onMouseDown, () => {\n      onClose();\n      isMousedown = true;\n      document.addEventListener(\"mouseup\", onMouseup, {\n        once: true\n      });\n    });\n    const onFocus = composeEventHandlers(props.onFocus, () => {\n      if (!isMousedown) onOpen();\n    });\n    const onBlur = composeEventHandlers(props.onBlur, onClose);\n    const onClick = composeEventHandlers(props.onClick, e => {\n      if (e.detail === 0) onClose();\n    });\n    const events = {\n      blur: onBlur,\n      click: onClick,\n      focus: onFocus,\n      mousedown: onMousedown,\n      mouseenter: onMouseenter,\n      mouseleave: onMouseleave\n    };\n\n    const setEvents = (el, events2, type) => {\n      if (el) {\n        Object.entries(events2).forEach(([name, handler]) => {\n          el[type](name, handler);\n        });\n      }\n    };\n\n    watch(triggerRef, (triggerEl, previousTriggerEl) => {\n      setEvents(triggerEl, events, \"addEventListener\");\n      setEvents(previousTriggerEl, events, \"removeEventListener\");\n\n      if (triggerEl) {\n        triggerEl.setAttribute(\"aria-describedby\", contentId.value);\n      }\n    });\n    onBeforeUnmount(() => {\n      setEvents(triggerRef.value, events, \"removeEventListener\");\n      document.removeEventListener(\"mouseup\", onMouseup);\n    });\n    return (_ctx, _cache) => {\n      return _ctx.nowrap ? (openBlock(), createBlock(unref(ForwardRef), {\n        key: 0,\n        \"set-ref\": setTriggerRef,\n        \"only-child\": \"\"\n      }, {\n        default: withCtx(() => [renderSlot(_ctx.$slots, \"default\")]),\n        _: 3\n      })) : (openBlock(), createElementBlock(\"button\", mergeProps({\n        key: 1,\n        ref_key: \"triggerRef\",\n        ref: triggerRef\n      }, _ctx.$attrs), [renderSlot(_ctx.$slots, \"default\")], 16));\n    };\n  }\n\n});\n\nvar TooltipV2Trigger = /* @__PURE__ */_export_sfc(_sfc_main, [[\"__file\", \"/home/runner/work/element-plus/element-plus/packages/components/tooltip-v2/src/trigger.vue\"]]);\n\nexport { TooltipV2Trigger as default };","map":{"version":3,"mappings":";;;;;;;;;;mCAiBc;EACZA,IAAM;AADM;;;;;;;;;IAcd,MAAM;MAAEC,OAAF;MAAWC,MAAX;MAAmBC,WAAnB;MAAgCC,UAAhC;MAA4CC;IAA5C,IACJC,OAAOC,gBAAP,CADF;IAGA,IAAIC,WAAc,QAAlB;;IAEM,sBAAiBC,EAAD,IAA4B;MAChDL,WAAWM,KAAX,GAAmBD,EAAnB;IACF,CAFM;;IAIN,MAAME,YAAY,MAAM;MACRH;IAChB,CAFA;;IAIA,MAAMI,YAAe,wBAAqBC,KAAM,aAA3B,EAAyCV,WAAzC,CAArB;IAEA,MAAMW,YAAe,wBAAqBD,KAAM,aAA3B,EAAyCZ,OAAzC,CAArB;IAEA,MAAMc,WAAc,wBAAqBF,KAAM,YAA3B,EAAwC,MAAM;MACxDZ;MACMO;MACdQ,SAASC,gBAAT,CAA0B,SAA1B,EAAqCN,SAArC,EAAgD;QAAEO,MAAM;MAAR,CAAhD;IACD,CAJmB,CAApB;IAMA,MAAMC,OAAU,wBAAqBN,KAAM,QAA3B,EAAoC,MAAM;MACxD,IAAI,CAACL,WAAL,EAAyBN;IAC1B,CAFe,CAAhB;IAIA,MAAMkB,MAAS,wBAAqBP,KAAM,OAA3B,EAAmCZ,OAAnC,CAAf;IAEA,MAAMoB,OAAU,wBAAqBR,KAAM,QAA3B,EAAqCS,CAAD,IAAO;MACzD,IAAKA,EAAiBC,MAAjB,KAA4B,CAAjC,EAA4CtB;IAC7C,CAFe,CAAhB;IAIA,MAAMuB,MAAS;MACbC,IAAM,QADO;MAEbC,KAAO,SAFM;MAGbC,KAAO,SAHM;MAIbC,SAAW,aAJE;MAKbC,UAAY,cALC;MAMbC,UAAY;IANC,CAAf;;IASA,MAAMC,SAAY,IAChBtB,EADgB,EAEhBuB,OAFgB,EAGhBC,IAHgB,KAIb;MACH,IAAIxB,EAAJ,EAAQ;QACNyB,OAAOC,OAAP,CAAeH,OAAf,EAAuBI,OAAvB,CAA+B,CAAC,CAACpC,IAAD,EAAOqC,OAAP,CAAD,KAAqB;UAC/C5B,SAAMT,IAAN,EAAYqC,OAAZ;QACJ,CAFD;MAGF;IACF,CAVA;;IAYMC,kBAAY,CAACC,SAAD,EAAYC,iBAAZ,KAAkC;MACxCT,qBAAWP,MAAX,EAAmB,kBAAnB;MACAO,6BAAmBP,MAAnB,EAA2B,qBAA3B;;MAEV,IAAIe,SAAJ,EAAe;QACHA,uBAAa,kBAAb,EAAiClC,UAAUK,KAA3C;MACZ;IACD,CAPK;IASN+B,gBAAgB,MAAM;MACVV,qBAAWrB,KAAX,EAAkBc,MAAlB,EAA0B,qBAA1B;MACDR,6BAAoB,SAApB,EAA+BL,SAA/B;IACV,CAHD","names":["name","onClose","onOpen","onDelayOpen","triggerRef","contentId","inject","tooltipV2RootKey","isMousedown","el","value","onMouseup","onMouseenter","props","onMouseleave","onMousedown","document","addEventListener","once","onFocus","onBlur","onClick","e","detail","events","blur","click","focus","mousedown","mouseenter","mouseleave","setEvents","events2","type","Object","entries","forEach","handler","watch","triggerEl","previousTriggerEl","onBeforeUnmount"],"sources":["../../../../../../packages/components/tooltip-v2/src/trigger.vue"],"sourcesContent":["<template>\n  <forward-ref v-if=\"nowrap\" :set-ref=\"setTriggerRef\" only-child>\n    <slot />\n  </forward-ref>\n  <button v-else ref=\"triggerRef\" v-bind=\"$attrs\">\n    <slot />\n  </button>\n</template>\n\n<script setup lang=\"ts\">\nimport { inject, onBeforeUnmount, watch } from 'vue'\nimport { composeEventHandlers } from '@element-plus/utils'\nimport { tooltipV2RootKey } from '@element-plus/tokens'\nimport ForwardRef from './forward-ref'\nimport { tooltipV2TriggerProps } from './trigger'\nimport { tooltipV2CommonProps } from './common'\n\ndefineOptions({\n  name: 'ElTooltipV2Trigger',\n})\n\nconst props = defineProps({\n  ...tooltipV2CommonProps,\n  ...tooltipV2TriggerProps,\n})\n\n/**\n * onOpen opens the tooltip instantly, onTrigger acts a lil bit differently,\n * it will check if delayDuration is set to greater than 0 and based on that result,\n * if true, it opens the tooltip after delayDuration, otherwise it opens it instantly.\n */\nconst { onClose, onOpen, onDelayOpen, triggerRef, contentId } =\n  inject(tooltipV2RootKey)!\n\nlet isMousedown = false\n\nconst setTriggerRef = (el: HTMLElement | null) => {\n  triggerRef.value = el\n}\n\nconst onMouseup = () => {\n  isMousedown = false\n}\n\nconst onMouseenter = composeEventHandlers(props.onMouseEnter, onDelayOpen)\n\nconst onMouseleave = composeEventHandlers(props.onMouseLeave, onClose)\n\nconst onMousedown = composeEventHandlers(props.onMouseDown, () => {\n  onClose()\n  isMousedown = true\n  document.addEventListener('mouseup', onMouseup, { once: true })\n})\n\nconst onFocus = composeEventHandlers(props.onFocus, () => {\n  if (!isMousedown) onOpen()\n})\n\nconst onBlur = composeEventHandlers(props.onBlur, onClose)\n\nconst onClick = composeEventHandlers(props.onClick, (e) => {\n  if ((e as MouseEvent).detail === 0) onClose()\n})\n\nconst events = {\n  blur: onBlur,\n  click: onClick,\n  focus: onFocus,\n  mousedown: onMousedown,\n  mouseenter: onMouseenter,\n  mouseleave: onMouseleave,\n}\n\nconst setEvents = <T extends (e: Event) => void>(\n  el: HTMLElement | null | undefined,\n  events: Record<string, T>,\n  type: 'addEventListener' | 'removeEventListener'\n) => {\n  if (el) {\n    Object.entries(events).forEach(([name, handler]) => {\n      el[type](name, handler)\n    })\n  }\n}\n\nwatch(triggerRef, (triggerEl, previousTriggerEl) => {\n  setEvents(triggerEl, events, 'addEventListener')\n  setEvents(previousTriggerEl, events, 'removeEventListener')\n\n  if (triggerEl) {\n    triggerEl.setAttribute('aria-describedby', contentId.value)\n  }\n})\n\nonBeforeUnmount(() => {\n  setEvents(triggerRef.value, events, 'removeEventListener')\n  document.removeEventListener('mouseup', onMouseup)\n})\n</script>\n"]},"metadata":{},"sourceType":"module"}